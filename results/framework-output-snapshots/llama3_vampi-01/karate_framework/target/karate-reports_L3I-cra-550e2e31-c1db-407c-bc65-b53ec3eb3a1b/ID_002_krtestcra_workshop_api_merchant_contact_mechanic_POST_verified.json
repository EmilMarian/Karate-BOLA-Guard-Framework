[{"line":1,"elements":[{"start_timestamp":"2024-11-13T07:59:44.260Z","line":2,"name":"Attempt to exploit OAuth token generation with a stolen authorization code","description":"","id":"attempt-to-exploit-oauth-token-generation-with-a-stolen-authorization-code","type":"scenario","keyword":"Scenario","steps":[{"name":"url \"http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic\"","result":{"duration":781104,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":3},{"name":"request","result":{"duration":589455,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":4,"doc_string":{"content_type":"","value":"{\n    \"grant_type\": \"authorization_code\",\n    \"code\": \"stolen_code\",\n    \"redirect_uri\": \"http:\/\/evil.example.com\",\n    \"client_id\": \"client_id\",\n    \"client_secret\": \"client_secret\"\n}","line":4}},{"name":"method post","result":{"duration":13767423,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":14,"doc_string":{"content_type":"","value":"07:59:44.264 request:\n1 > POST http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 155\n1 > Host: 192.168.1.112:8888\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.2)\n1 > Accept-Encoding: gzip,deflate\n{\"grant_type\":\"authorization_code\",\"code\":\"stolen_code\",\"redirect_uri\":\"http:\\\/\\\/evil.example.com\",\"client_id\":\"client_id\",\"client_secret\":\"client_secret\"}\n\n07:59:44.274 response time in milliseconds: 9\n1 < 401\n1 < Server: openresty\/1.25.3.1\n1 < Date: Wed, 13 Nov 2024 07:59:44 GMT\n1 < Content-Type: application\/json\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Allow: POST, OPTIONS\n1 < Vary: origin, Cookie\n1 < X-Frame-Options: DENY\n1 < X-Content-Type-Options: nosniff\n1 < Referrer-Policy: same-origin\n1 < Cross-Origin-Opener-Policy: same-origin\n{\"message\":\"JWT Token required!\"}\n\n","line":14}},{"name":"status 400","result":{"duration":74612,"error_message":"status code was: 401, expected: 400, response time in milliseconds: 9, url: http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic, response: \n{\"message\":\"JWT Token required!\"}\nclasspath:ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature:15","status":"failed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":15,"doc_string":{"content_type":"","value":"07:59:44.276 classpath:ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature:15\nThen status 400\nstatus code was: 401, expected: 400, response time in milliseconds: 9, url: http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic, response: \n{\"message\":\"JWT Token required!\"}\nclasspath:ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature:15\n","line":15}},{"name":"match response contains \"Invalid grant: authorization code is invalid\"","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":16}],"tags":[]}],"name":"ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature","description":"test","id":"test","keyword":"Feature","uri":"ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature"}]