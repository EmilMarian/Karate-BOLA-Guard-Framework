{"failedCount":1,"prefixedPath":"classpath:ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature","packageQualifiedName":"ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified","loopIndex":-1,"relativePath":"ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":781104,"startTime":1731484784260,"endTime":1731484784261,"millis":0.781104,"status":"passed"},"step":{"line":3,"prefix":"Given","index":0,"text":"url \"http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic\""}},{"result":{"nanos":589455,"startTime":1731484784261,"endTime":1731484784262,"millis":0.589455,"status":"passed"},"step":{"endLine":13,"line":4,"prefix":"And","docString":"{\n    \"grant_type\": \"authorization_code\",\n    \"code\": \"stolen_code\",\n    \"redirect_uri\": \"http:\/\/evil.example.com\",\n    \"client_id\": \"client_id\",\n    \"client_secret\": \"client_secret\"\n}","index":1,"text":"request"}},{"result":{"nanos":13767423,"startTime":1731484784262,"endTime":1731484784276,"millis":13.767423,"status":"passed"},"step":{"line":14,"prefix":"When","index":2,"text":"method post"},"stepLog":"07:59:44.264 request:\n1 > POST http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 155\n1 > Host: 192.168.1.112:8888\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.2)\n1 > Accept-Encoding: gzip,deflate\n{\"grant_type\":\"authorization_code\",\"code\":\"stolen_code\",\"redirect_uri\":\"http:\\\/\\\/evil.example.com\",\"client_id\":\"client_id\",\"client_secret\":\"client_secret\"}\n\n07:59:44.274 response time in milliseconds: 9\n1 < 401\n1 < Server: openresty\/1.25.3.1\n1 < Date: Wed, 13 Nov 2024 07:59:44 GMT\n1 < Content-Type: application\/json\n1 < Transfer-Encoding: chunked\n1 < Connection: keep-alive\n1 < Allow: POST, OPTIONS\n1 < Vary: origin, Cookie\n1 < X-Frame-Options: DENY\n1 < X-Content-Type-Options: nosniff\n1 < Referrer-Policy: same-origin\n1 < Cross-Origin-Opener-Policy: same-origin\n{\"message\":\"JWT Token required!\"}\n\n"},{"result":{"nanos":74612,"errorMessage":"status code was: 401, expected: 400, response time in milliseconds: 9, url: http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic, response: \n{\"message\":\"JWT Token required!\"}\nclasspath:ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature:15","startTime":1731484784276,"endTime":1731484784276,"millis":0.074612,"status":"failed"},"step":{"line":15,"prefix":"Then","index":3,"text":"status 400"},"stepLog":"07:59:44.276 classpath:ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature:15\nThen status 400\nstatus code was: 401, expected: 400, response time in milliseconds: 9, url: http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic, response: \n{\"message\":\"JWT Token required!\"}\nclasspath:ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature:15\n"},{"result":{"nanos":0,"startTime":1731484784276,"endTime":1731484784276,"millis":0.0,"status":"skipped"},"step":{"line":16,"prefix":"And","index":4,"text":"match response contains \"Invalid grant: authorization code is invalid\""}}],"line":2,"description":"","durationMillis":15.212594,"failed":true,"error":"status code was: 401, expected: 400, response time in milliseconds: 9, url: http:\/\/192.168.1.112:8888\/workshop\/api\/merchant\/contact_mechanic, response: \n{\"message\":\"JWT Token required!\"}\nclasspath:ID_002_krtestcra_workshop_api_merchant_contact_mechanic_POST_verified.feature:15","executorName":"main","name":"Attempt to exploit OAuth token generation with a stolen authorization code","startTime":1731484784260,"refId":"[1:2]","endTime":1731484784276,"exampleIndex":-1}],"callDepth":0,"name":"test","description":"","resultDate":"2024-11-13 07:59:44 AM","durationMillis":15.212594,"passedCount":0}